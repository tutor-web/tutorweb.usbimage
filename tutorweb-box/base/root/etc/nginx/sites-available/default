upstream shellinabox {
  server 127.0.0.1:4200;
}

server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /srv/eias.lan/www;

    location /scripts/ {
        gzip off;
        root  /srv/eias.lan/scripts;

        fastcgi_pass  unix:/var/run/fcgiwrap.socket;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_FILENAME  /srv/eias.lan/$fastcgi_script_name;
    }

    location /shell/ {
        proxy_pass http://shellinabox;
        proxy_cache off;
    }
}

server {
  listen [::]:80;
  listen      80;
  server_name captive.apple.com;
  server_name connectivitycheck.gstatic.com;
  server_name clients3.google.com;
  server_name detectportal.firefox.com;

  root /srv/eias.lan/www;

  location /success.txt {  # http://detectportal.firefox.com/success.txt
    add_header Content-Type text/plain;
    return 200 'success';
  }

  location /hotspot-detect.html {
    add_header Content-Type text/html;
    return 200 '<HTML><HEAD><TITLE>Success</TITLE></HEAD><BODY>Success</BODY></HTML>';
  }

  location /generate_204 {
    return 204;
  }
}
